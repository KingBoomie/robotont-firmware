import serial

import signal
import sys
import time
millis = int(round(time.time() * 1000))
try:
    # Initialize serial connection
    ser = serial.Serial('/dev/ttyACM1', 115200)
except Exception as e:
    print("Failed to establish a serial connection:")
    print(e)
    sys.exit(-1)

sisend = input("sisesta fps: ")
fps = 1000/ int(sisend)

while True:
    # Read the serial input to string
    if  int(round(time.time() * 1000)) - millis >= fps:
        ser.write(str.encode("{\"MS\":{\"M1\": 50,\"M2\": 50,\"M3\": 50}, \"LED\": [377295910000000, 455050710000000, 543311310000000, 224536610000000, 217903010000000, 199702410000000, 200937910000000, 509250110000000, 273017710000000, 161401910000000, 366065310000000, 11773010000000, 422342410000000, 564275010000000, 2685010000000, 192985910000000, 485683410000000, 433008610000000, 633495110000000, 525506110000000, 422350810000000, 461670610000000, 131324410000000, 474608910000000, 14162610000000, 376584210000000, 60343010000000, 343034010000000, 341093310000000, 10763410000000, 521190210000000, 370977310000000, 163292410000000, 254191510000000, 577283210000000, 589509110000000, 237405610000000, 387858110000000, 483784210000000, 449907210000000, 442025410000000, 407161610000000, 440840410000000, 283628110000000, 53605010000000, 289230910000000, 142048210000000, 38562510000000, 397338710000000, 473870510000000, 188922810000000, 345954110000000, 516496010000000, 368449310000000, 116557110000000, 39740610000000, 349780310000000, 311106510000000, 48776110000000]}\n")) 
        millis = int(round(time.time() * 1000))
